var zs=function(e){"use strict";return e.deprecated("table.js","Since v3.1. Will be removed in v4.0. We have tableElement.js, stickyHeader.js, smart.js, pivot.js, sort.js, fixedColumns.js, delayedRender now."),e.tableFixedColumns={fixedColumnCount:0,scrollEl:null,matchScroll:function(e,t){e._scrollTop&&e._scrollTop==t.scrollTop||(e._scrollTop=t.scrollTop,e.scrollTop=t.scrollTop)},decorateFixedHeaders:function(e){e.setAttribute("locked",!0)},resizeFixed:function(e){if(this.table&&e){var t=this.fixedTable||e.firstChild;if(t)for(var i=this.table.querySelectorAll("tr"),n=t.querySelectorAll("tr"),a=0;a<i.length;a++){i[a].firstChild,n[a].firstChild;var s=i[a].offsetHeight-n[a].offsetHeight,r=i[a].clientHeight;0<s?r=n[a].clientHeight+s:s<0&&(r=i[a].clientHeight-s),i[a].style.minHeight=r+"px",n[a].style.minHeight=r+"px",i[a].style.maxHeight=r+"px",n[a].style.maxHeight=r+"px",i[a].style.height=r+"px",n[a].style.height=r+"px"}}},scrollFix:function(e){},whenRendered:function(){var d=this;return new Promise(function(l,e){setTimeout(function(){if(d.table){var e=d.table.querySelector("tbody");if(e){var t=e.lastChild;if(t){var i=(s=t.lastChild)&&s.offsetHeight,n=0,a=d.table.offsetHeight;if(d.fixedTable){if(!(e=d.fixedTable.querySelector("tbody")))return void l();if(!(t=e.lastChild))return void l();n=(s=t.lastChild)&&s.offsetHeight;var s,r=d.fixedTable.offsetHeight}l(i+","+n+","+a+","+r)}else l()}else l()}else l()},0)})},renderHeadRow:function(e){var t,i=this.headData||this.data[0];if((t=document.createElement("tr")).setAttribute("key",-1),Array.isArray(i))for(var n=0;n<i.length;n++){var a=this.renderHead(-1,n,i[n]);this.fixedColumnCount>n?e.appendChild(a):t.appendChild(a)}else{var s=-1;for(var n in i){s++;a=this.renderHead(-1,n,n);this.fixedColumnCount>s?e.appendChild(a):t.appendChild(a)}}return t},renderRow:function(e,t,i){if(null==t)return i=null;var n=document.createElement("tr");if(n.setAttribute("key",e),Array.isArray(t))for(var a=0;a<t.length;a++){var s=this.renderCell(e,a,t[a]);this.fixedColumnCount>a?i.appendChild(s):n.appendChild(s)}else{var r=-1;for(var a in t){r++;s=this.renderCell(e,a,t[a]);this.fixedColumnCount>r?i.appendChild(s):n.appendChild(s)}}return n},renderTable:function(e,t){var i,n,a,s=this;if(s.loadingSet(!0,s),this.tableContainer||(this.tableContainer=document.createElement("div"),this.appendChild(this.tableContainer)),n=this.tableContainer,s.scrollEl=n,this.clearTable(),this.table||(this.table=this.querySelector("table")||document.createElement("table"),this.table.classList.add("zs-data-table"),this.table.style.tableLayout="fixed"),this.thead||(this.thead=this.table.querySelector("thead")||document.createElement("thead"),this.table.appendChild(this.thead)),this.tbody||(this.tbody=this.table.querySelector("tbody")||document.createElement("tbody"),this.table.appendChild(this.tbody)),this.fixedColumnCount){this.fixedContainer?this.fixedContainer.innerHTML="":(this.fixedContainer=this.querySelector(".zs-fixed"),this.fixedContainer||(this.fixedContainer=document.createElement("div"),this.appendChild(this.fixedContainer))),this.fixedTable?this.fixedTable.innerHTML="":(this.fixedTable=document.createElement("table"),this.fixedTable.setAttribute("class",this.table.getAttribute("class")),this.fixedTable.style.tableLayout="fixed",this.fixedContainer.appendChild(this.fixedTable)),this.fixedTableHead=document.createElement("thead"),this.fixedTableBody=document.createElement("tbody"),this.fixedContainer.setAttribute("class","zs-fixed"),this.fixedContainer.style.position="absolute",this.considerPosition("relative"),this.fixedContainer.style.bottom="0px",this.fixedContainer.style.left="0px",this.fixedContainer.style.overflowY="hidden";var r=!(this.fixedContainer.style.top="0px");s.scrollEl.addEventListener("scroll",function(e){r||(r=!0,window.requestAnimationFrame(function(){r=!1,s.matchScroll(s.fixedContainer,s.scrollEl)}))}),this.scrollFix(s.scrollEl),this.addEventListener("resize",function(){s.resizeFixed(s.fixedContainer,s.scrollEl)})}if(this.fixedColumnCount){var l=document.createElement("tr");this.thead.appendChild(this.renderHeadRow(l)),this.fixedTableHead.appendChild(l)}else this.thead.appendChild(this.renderHeadRow());for(i=0;i<e.length;i++)this.fixedColumnCount&&(l=document.createElement("tr"),a=this.renderRow(i,e[i],l)),a&&this.tbody.appendChild(a),l&&this.fixedTableBody.appendChild(l);n.appendChild(this.table),this.fixedColumnCount&&(this.fixedTable.appendChild(this.fixedTableHead),this.fixedTable.appendChild(this.fixedTableBody)),this.whenRendered().then(function(){s.fixedColumnCount&&(s.resizeFixed(s.fixedContainer,s.scrollEl),s.matchScroll(s.fixedContainer,s.scrollEl),n.style.marginLeft=s.fixedContainer.offsetWidth+"px",s.fixedContainer.firstChild.style.marginBottom="100px",s.fixedContainer.style.height=n.offsetHeight+"px"),s.loadingSet(!1,s),s.dispatchEvent(new CustomEvent("render"))})}},e.tableStickyHeader={decorateStickyCell:function(e){},resizeStickyHeader:function(e,t,i){if(t&&e&&i){for(var n=e.querySelector("thead").querySelectorAll("td,th"),a=t.querySelectorAll("td,th"),s=0;s<n.length;s++){var r=n[s],l=a[s];l&&(l.style.whiteSpace="normal",l.style.width=r.clientWidth+(r.offsetLeft-l.offsetLeft)+"px",l.style.height=r.clientHeight+r.offsetHeight-r.clientHeight+"px",l.style.minWidth=l.style.width,l.style.maxWidth=l.style.width,this.decorateStickyCell(l))}var d=i.offsetWidth-i.clientWidth,h=t.querySelector("[bar]");d?(h||((h=document.createElement("td")).setAttribute("bar","true"),t.firstChild.firstChild.firstChild.appendChild(h)),h.style.width=d+"px"):h&&t.firstChild.firstChild.firstChild.removeChild(h);var o=t.offsetHeight,c=e.querySelector("thead td").offsetHeight;t.style.left="0px",t.style.top="0px",t.style.marginLeft=i.style.marginLeft,t.parentNode&&(t.parentNode.style.paddingTop=o+"px"),t.style.width=i.offsetWidth+"px",e.style.marginTop=-c+"px"}},scrollStickyHeader:function(e,t,i){e&&t&&i&&(t.scrollLeft=i.scrollLeft)},stickHeader:function(t,i,n){var a=this;if(t&&n){i||(i=t.stickyContainer)||((i=document.createElement("div")).style.visibility="hidden",t.stickyContainer=i),this.appendChild(i),i.firstChild&&i.removeChild(i.firstChild),i.classList.add("zs-sticky"),i.style.overflowX="hidden",i.style.position="absolute";var s=!(i.parentNode.style.position="relative");n.addEventListener("scroll",function(e){s||(s=!0,window.requestAnimationFrame(function(){s=!1,a.scrollStickyHeader(t,i,n)}))});var e=t.querySelector("thead").cloneNode(!0),r=document.createElement("table");return r.classList.add("zs-data-table"),r.appendChild(e),t.style.tableLayout="fixed",i.appendChild(r),i.firstChild.style.marginBottom="0",i.firstChild.firstChild.firstChild&&(i.firstChild.firstChild.firstChild.style.whiteSpace="nowrap"),setTimeout(function(){a.resizeStickyHeader(t,i,n),a.scrollStickyHeader(t,i,n),i.style.visibility="visible",t.parentNode&&t.parentNode.classList.contains("zs-fixed")&&(t.parentNode.style.top="")},0),i}}},e.table={data:null,tableContainer:null,events:{create:function(){this.data=[]}},render:function(){this.renderTable(this.data)},refreshTable:function(e){var t=this;this.getTableData(e).then(function(e){t.data=e,t.renderTable(e),t.loadingSet(!1,t.querySelector(".zs-table"))})},getTableData:function(e){return new Promise(function(e,t){e([])})},considerPosition:function(e){this.style.position&&"auto"!=!this.style.position||(this.style.position="relative")},renderRow:function(e,t){var i=document.createElement("tr");if(i.setAttribute("key",e),Array.isArray(t))for(var n=0;n<t.length;n++)i.appendChild(this.renderCell(e,n,t[n]));else for(var n in t)i.appendChild(this.renderCell(e,n,t[n]));return i},renderHeadRow:function(){var e,t=this.headData||this.data[0];if((e=document.createElement("tr")).setAttribute("key",-1),Array.isArray(t))for(var i=0;i<t.length;i++)e.appendChild(this.renderHead(-1,i,t[i]));else for(var i in t)e.appendChild(this.renderHead(-1,i,i));return e},renderHead:function(e,t,i){var n=document.createElement("td");return n.setAttribute("key",t),n.innerHTML=i,n},renderCell:function(e,t,i){var n=document.createElement("td");return n.setAttribute("key",t),n.innerHTML=i,n},clearTable:function(){if(this.thead){for(;this.thead.firstChild;)this.thead.removeChild(this.thead.firstChild);this.thead=null}if(this.tbody){for(;this.tbody.firstChild;)this.tbody.removeChild(this.tbody.firstChild);this.tbody=null}this.table&&this.table.parentNode&&(this.table.parentNode.removeChild(this.table),this.table=null)},whenRendered:function(){var s=this;return new Promise(function(e,t){if(s.table){var i=s.table.querySelector("tbody");if(i){var n=i.lastChild;if(n){var a=n.lastChild;e(a&&a.offsetHeight)}else e()}else e()}else e()})},renderTable:function(e,t){var i,n=this,a=this.tableContainer||this;for(this.clearTable(),this.table||(this.table=this.querySelector("table")||document.createElement("table"),this.table.classList.add("zs-data-table"),this.table.style.tableLayout="fixed"),this.thead||(this.thead=this.table.querySelector("thead")||document.createElement("thead"),this.table.appendChild(this.thead)),this.tbody||(this.tbody=this.table.querySelector("tbody")||document.createElement("tbody"),this.table.appendChild(this.tbody)),this.thead.appendChild(this.renderHeadRow()),i=0;i<e.length;i++){var s=this.renderRow(i,e[i]);s&&this.tbody.appendChild(s)}a.appendChild(this.table),this.whenRendered().then(function(){n.dispatchEvent(new CustomEvent("render"))})}},e.tableSortable={events:{},addSortableListener:function(e,t,i){var n=this,a=e.getAttribute("sorting-elm")||"a",s=e.getAttribute("sorting-event")||"click",r=document.createElement(a),l=new CustomEvent("sort",{detail:{elm:e}});if(i)r.innerHTML=e.textContent,e.innerHTML="";else for(;e.firstChild;)r.appendChild(e.firstChild);return r.addEventListener(s,function(e){n.dispatchEvent(l)}),e.appendChild(r),t?r.setAttribute("sort",t):r.removeAttribute("sort"),e}},e.tablePivot={renderPivotTable:function(){this.table=document.createElement("table"),this.table.className="zs-data-table",this.table.appendChild(this.renderPivotHead()),this.table.appendChild(this.renderPivotBody()),this.appendChild(this.table);var e=this;this.whenRendered().then(function(){e.dispatchEvent(new CustomEvent("render"))})},renderPivotHead:function(){return this.thead=document.createElement("thead"),this.thead},renderPivotBody:function(){return this.tbody=document.createElement("tbody"),this.tbody},createPivotItem:function(e){e=e||{};var t=document.createElement(e.name);if(e.text&&(t.innerText=e.text),e.className&&(t.className+=" "+e.className),e.style)for(var i in e.style)t.style[i]=e.style[i];for(var n in delete e.name,delete e.text,delete e.className,delete e.style,e)t.setAttribute(n,e[n]);return t}},e.tableSmartRender={_data:null,_hash:null,_rowHash:null,_changes:null,getRowKey:function(e,t){return e},getHash:function(e){return JSON.stringify(e)},getRowHash:function(e,t){return JSON.stringify(t)},properties:{data:{set:function(e){this.detectChangesUpdateHash(e)},get:function(){return this._data}}},detectChangesUpdateHash:function(e){null!=this._data&&this._rowHash&&this.detectChanges(e);var t=performance.now();this._rowHash={},this._hash="";for(var i=0;i<e.length;i++){var n=e[i],a=this.getRowHash(i,n);this._rowHash[this.getRowKey(i,n)]={hash:a,data:n,index:i},this._hash+=(""==this._hash?"":",")+a}this._hash="["+this._hash+"]",console.log("hashes created in",performance.now()-t),this._data=e},detectChanges:function(e){var t=performance.now();this._changes={};var i=this.getHash(e);if(this._hash==i)return console.log("no changes"),this._changes=!1,this._changes;if((null==this._data||0==this._data.length)&&e&&e.length)return console.log("new data"),this._changes=-1,this._changes;for(var n={},a=0;a<e.length;a++){var s=e[a],r=this.getRowKey(a,s),l=this.getRowHash(a,s);n[r]={hash:l,data:s,index:a},this._rowHash[r]?(this._rowHash[r].hash!=l&&(this._changes.modify||(this._changes.modify=[]),this._changes.modify.push({key:r,index:a,data:s})),this._rowHash[r].index!=a&&(this._changes.move||(this._changes.move=[]),this._changes.move.push({key:r,index:a,data:s}))):(this._changes.add||(this._changes.add=[]),this._changes.add.push({key:r,index:a,data:s}))}for(var a in this._rowHash)n[a]||(this._changes.remove||(this._changes.remove=[]),this._changes.remove.push({key:a,index:this._rowHash[a].index,data:this._rowHash[a].data}));return console.log("changes detected",this._changes,"in "+(performance.now()-t)),this._changes},renderChanges:function(){this.tableContainer;var e,t,i,n,a,s,r=this;if(this._changes)if(-1!=this._changes)if(this._changes.move)this.renderTable(this.data);else{if(this._changes.remove)for(t=this._changes.remove,e=0;e<t.length;e++)n=t[e].data,i=t[e].key,(a=this.tbody.querySelector('tr[key="'+i+'"]'))&&a.parentNode.removeChild(a);if(this._changes.modify)for(t=this._changes.modify,e=0;e<t.length;e++)n=t[e].data,i=t[e].key,a=this.renderRow(i,n),(s=this.tbody.querySelector('tr[key="'+i+'"]'))&&s.parentNode.replaceChild(a,s);if(this._changes.add)for(t=this._changes.add,e=0;e<t.length;e++)n=t[e].data,i=t[e].key,a=this.renderRow(i,n),this.tbody.appendChild(a);this.whenRendered().then(function(){r.dispatchEvent(new CustomEvent("render"))})}else this.renderTable(this.data)}},e.tableElement=e.customElement(HTMLDivElement,"zs-table","div",[e.loading,e.table]),e}(window.zs||{});
//# sourceMappingURL=table.min.js.map