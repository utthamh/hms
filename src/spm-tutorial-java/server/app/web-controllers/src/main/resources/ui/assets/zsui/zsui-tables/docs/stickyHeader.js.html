<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>stickyHeader.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ZS%252520TablePivot.html">ZS TablePivot</a></li><li><a href="ZS%252520TableSortable.html">ZS TableSortable</a></li></ul><h3>Events</h3><ul><li><a href="global.html#event:cellchangeFireswhenwecelldataischanged">cellchange Fires when we cell data is changed</a></li><li><a href="global.html#event:resizeFireswhenweresizetable">resize Fires when we resize table</a></li></ul><h3>Namespaces</h3><ul><li><a href="zs.table.html">table</a><ul class='methods'><li data-type='method'><a href="zs.table.html#.clearTable">clearTable</a></li><li data-type='method'><a href="zs.table.html#.considerPosition">considerPosition</a></li><li data-type='method'><a href="zs.table.html#.getTableData">getTableData</a></li><li data-type='method'><a href="zs.table.html#.refreshTable">refreshTable</a></li><li data-type='method'><a href="zs.table.html#.render">render</a></li><li data-type='method'><a href="zs.table.html#.renderCell">renderCell</a></li><li data-type='method'><a href="zs.table.html#.renderHead">renderHead</a></li><li data-type='method'><a href="zs.table.html#.renderHeadRow">renderHeadRow</a></li><li data-type='method'><a href="zs.table.html#.renderRow">renderRow</a></li><li data-type='method'><a href="zs.table.html#.renderTable">renderTable</a></li><li data-type='method'><a href="zs.table.html#.whenRendered">whenRendered</a></li></ul></li><li><a href="zs.tableDelayedRender.html">tableDelayedRender</a><ul class='methods'><li data-type='method'><a href="zs.tableDelayedRender.html#.renderTable">renderTable</a></li><li data-type='method'><a href="zs.tableDelayedRender.html#.renderTableSection">renderTableSection</a></li></ul></li><li><a href="zs.tableEditable.html">tableEditable</a><ul class='methods'><li data-type='method'><a href="zs.tableEditable.html#.cellClick">cellClick</a></li><li data-type='method'><a href="zs.tableEditable.html#.createField">createField</a></li><li data-type='method'><a href="zs.tableEditable.html#.fieldChange">fieldChange</a></li><li data-type='method'><a href="zs.tableEditable.html#.focusEditField">focusEditField</a></li><li data-type='method'><a href="zs.tableEditable.html#.formatCell">formatCell</a></li><li data-type='method'><a href="zs.tableEditable.html#.isEditable">isEditable</a></li><li data-type='method'><a href="zs.tableEditable.html#.nextField">nextField</a></li><li data-type='method'><a href="zs.tableEditable.html#.onWindowResize">onWindowResize</a></li><li data-type='method'><a href="zs.tableEditable.html#.positionOverlay">positionOverlay</a></li><li data-type='method'><a href="zs.tableEditable.html#.prevField">prevField</a></li><li data-type='method'><a href="zs.tableEditable.html#.renderCell">renderCell</a></li><li data-type='method'><a href="zs.tableEditable.html#.renderField">renderField</a></li><li data-type='method'><a href="zs.tableEditable.html#.renderOverlay">renderOverlay</a></li><li data-type='method'><a href="zs.tableEditable.html#.updateCellData">updateCellData</a></li></ul></li><li><a href="zs.tableFixedColumns.html">tableFixedColumns</a><ul class='methods'><li data-type='method'><a href="zs.tableFixedColumns.html#.decorateFixedHeaders">decorateFixedHeaders</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.matchScroll">matchScroll</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.renderHeadRow">renderHeadRow</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.renderHeadRow">renderHeadRow</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.renderRow">renderRow</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.renderRow">renderRow</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.renderTable">renderTable</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.renderTable">renderTable</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.resizeFixed">resizeFixed</a></li><li data-type='method'><a href="zs.tableFixedColumns.html#.whenRendered">whenRendered</a></li></ul></li><li><a href="zs.tableFixedColumnsDelayed.html">tableFixedColumnsDelayed</a><ul class='methods'><li data-type='method'><a href="zs.tableFixedColumnsDelayed.html#.renderTable">renderTable</a></li><li data-type='method'><a href="zs.tableFixedColumnsDelayed.html#.renderTableSection">renderTableSection</a></li></ul></li><li><a href="zs.html#.tableSmartRender">tableSmartRender</a><ul class='methods'><li data-type='method'><a href="zs.html#.tableSmartRender#.detectChanges">detectChanges</a></li><li data-type='method'><a href="zs.html#.tableSmartRender#.detectChanges">detectChanges</a></li><li data-type='method'><a href="zs.html#.tableSmartRender#.detectChangesUpdateHash">detectChangesUpdateHash</a></li><li data-type='method'><a href="zs.html#.tableSmartRender#.detectChangesUpdateHash">detectChangesUpdateHash</a></li><li data-type='method'><a href="zs.html#.tableSmartRender#.getHash">getHash</a></li><li data-type='method'><a href="zs.html#.tableSmartRender#.getRowHash">getRowHash</a></li><li data-type='method'><a href="zs.html#.tableSmartRender#.getRowKey">getRowKey</a></li><li data-type='method'><a href="zs.html#.tableSmartRender#.renderChanges">renderChanges</a></li></ul></li><li><a href="zs.tableStickyHeader.html">tableStickyHeader</a><ul class='methods'><li data-type='method'><a href="zs.tableStickyHeader.html#.clearTable">clearTable</a></li><li data-type='method'><a href="zs.tableStickyHeader.html#.decorateStickyCell">decorateStickyCell</a></li><li data-type='method'><a href="zs.tableStickyHeader.html#.resizeStickyHeader">resizeStickyHeader</a></li><li data-type='method'><a href="zs.tableStickyHeader.html#.scrollStickyHeader">scrollStickyHeader</a></li><li data-type='method'><a href="zs.tableStickyHeader.html#.stickHeader">stickHeader</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">stickyHeader.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var zs = (function (zs) {
	'use strict';
	
	/**
	 * Sticky header behavior for the sticky header table.
	 * @namespace
	 */
	zs.tableStickyHeader = {
		
		/**
		 * Hook provided to decorate/apply styles to the sticky cell.
		 * @param {HTMLElement} cell Sticky cell element.
		 */
		decorateStickyCell: function (cell) {

		},

		/**
		 * Matches the width and height of headers in the sticky header and the table.
		 * @param {HTMLElement} targetTable Reference to table element.
		 * @param {HTMLElement} stickyContainer Reference to sticky cell container.
		 * @param {HTMLElement} scrollEl Reference to scroll element.
		 */
		resizeStickyHeader: function (targetTable, stickyContainer, scrollEl) {
			if (!stickyContainer || !targetTable || !scrollEl) { return; }
			// Need to match the width and height of headers in the sticky header and the table.
			// FF renders headers first and then resizes them.
			var cells = targetTable.querySelector('thead').querySelectorAll('td,th');
			var stickyCells = stickyContainer.querySelectorAll('td,th');

			for (var i = 0; i &lt; cells.length; i++) {
				var cell = cells[i];
				var stickyCell = stickyCells[i];
				if (stickyCell) {
					//stickyCell.style.display = 'inline-block';
					stickyCell.style.whiteSpace = 'normal'; // Because parent white-space is nowrap

					stickyCell.style.width = cell.clientWidth + (cell.offsetLeft - stickyCell.offsetLeft) + 'px'; // IE11 we need to compensate 
					stickyCell.style.height = cell.clientHeight + cell.offsetHeight - cell.clientHeight + 'px'; // Why?
					//alert(1);
					//console.log('cell', cell.clientWidth, cell.offsetLeft, stickyCell.offsetLeft);

					stickyCell.style.minWidth = stickyCell.style.width;
					stickyCell.style.maxWidth = stickyCell.style.width;

					this.decorateStickyCell(stickyCell);
				}
			}


			// Compensate for scrolling
			var delta = scrollEl.offsetWidth - scrollEl.clientWidth;
			var bar = stickyContainer.querySelector('[bar]');
			if (delta) {
				if (!bar) {
					bar = document.createElement('td');
					bar.setAttribute('bar', 'true');
					stickyContainer.firstElementChild.firstElementChild.firstElementChild.appendChild(bar);
				}
				bar.style.width = delta + 'px';

			} else if (bar) {
				stickyContainer.firstElementChild.firstElementChild.firstElementChild.removeChild(bar);
			}

			// Set position
			//var rect = scrollEl.getBoundingClientRect();

			var stickyHeaderHeight = stickyContainer.offsetHeight;
			var headerHeight = targetTable.querySelector('thead').offsetHeight;

			stickyContainer.style.left = '0px';
			stickyContainer.style.top = '0px';
			stickyContainer.style.marginLeft = scrollEl.style.marginLeft;

			if (stickyContainer.parentNode) {
				stickyContainer.parentNode.style.paddingTop = stickyHeaderHeight + 'px';
			}

			stickyContainer.style.width = scrollEl.offsetWidth + 'px';
			targetTable.style.marginTop = -headerHeight + 'px';


		},

		/**
		 * Scrolls the sticky container in parallel with scroll element.
		 * @param {HTMLElement} targetTable Reference to table element.
		 * @param {HTMLElement} stickyContainer Reference to sticky cell container.
		 * @param {HTMLElement} scrollEl Reference to scroll element.
		 */
		scrollStickyHeader: function (targetTable, stickyContainer, scrollEl) {
			if (!targetTable || !stickyContainer || !scrollEl) {
				return;
			}
			stickyContainer.scrollLeft = scrollEl.scrollLeft;
		},

		/**
		 * Clears the table DOM and corresponding stored references.
		 */
		clearTable: function () {
			if (this.thead) {
				while (this.thead.firstChild) {
					this.thead.removeChild(this.thead.firstChild);
				}
				this.thead = null;
			}
			if (this.tbody) {
				while (this.tbody.firstChild) {
					this.tbody.removeChild(this.tbody.firstChild);
				}
				this.tbody = null;
			}
			if (this.table &amp;&amp; this.table.stickyContainer) {
				while (this.table.stickyContainer.firstChild) {
					this.table.stickyContainer.removeChild(this.table.stickyContainer.firstChild);
				}
				this.table.stickyContainer = null;
			}
			if (this.table &amp;&amp; this.table.parentNode) {
				this.table.parentNode.removeChild(this.table);
				this.table = null;
			}
		},

		/**
		 * Creates and renders the sticky portion of the table.
		 * @param {HTMLElement} targetTable Reference to table element.
		 * @param {HTMLElement} stickyContainer Reference to sticky cell container.
		 * @param {HTMLElement} scrollEl Reference to scroll element.
		 * @returns {HTMLElement} stickyContainer Reference to sticky container.
		 */
		stickHeader: function (targetTable, stickyContainer, scrollEl) {
			// Can be applied to any target table			
			var comp = this;

			// Can't work without proper parameters
			if (!targetTable || !scrollEl) {
				return;
			}

			if (!stickyContainer) {
				stickyContainer = targetTable.stickyContainer;
				if (!stickyContainer) {
					stickyContainer = document.createElement('div');
					stickyContainer.style.visibility = 'hidden';
					targetTable.stickyContainer = stickyContainer;
				}
			}

			if (stickyContainer &amp;&amp; !targetTable.stickyContainer) {
				targetTable.stickyContainer = stickyContainer;
			}

			this.appendChild(stickyContainer);

			// Clear sticky container
			if (stickyContainer.firstElementChild) {
				stickyContainer.removeChild(stickyContainer.firstElementChild);
			}

			// Style sticky header
			stickyContainer.classList.add('zs-sticky');
			stickyContainer.style.overflowX = 'hidden';
			stickyContainer.style.position = 'absolute';
			stickyContainer.parentNode.style.position = 'relative';

			// Listen to scroll to shift the sticky header.
			var waiting = false;
			scrollEl.addEventListener('scroll', function (event) {
				if (!waiting) {
					waiting = true;
					window.requestAnimationFrame(function () {
						waiting = false;
						comp.scrollStickyHeader(targetTable, stickyContainer, scrollEl);
					});
				}
			});

			// Duplicate table headers
			var thead = targetTable.querySelector('thead').cloneNode(true);
			var table = document.createElement('table');
			table.classList.add('zs-data-table');
			table.appendChild(thead);
			targetTable.style.tableLayout = 'fixed';


			stickyContainer.appendChild(table);
			//stickyContainer.firstElementChild.style.display = 'block'; // table
			stickyContainer.firstElementChild.style.marginBottom = '0';


			//stickyContainer.firstElementChild.firstElementChild.style.display = 'block'; // thead
			if (stickyContainer.firstElementChild.firstElementChild.firstElementChild) { // If we have tr
				//stickyContainer.firstElementChild.firstElementChild.firstElementChild.style.display = 'block'; // tr
				stickyContainer.firstElementChild.firstElementChild.firstElementChild.style.whiteSpace = 'nowrap';
			}

			// Yield to IE11
			setTimeout(function () {
				comp.resizeStickyHeader(targetTable, stickyContainer, scrollEl);
				comp.scrollStickyHeader(targetTable, stickyContainer, scrollEl);
				stickyContainer.style.visibility = 'visible';
				if (targetTable.parentNode &amp;&amp; targetTable.parentNode.classList.contains("zs-fixed")) {
					targetTable.parentNode.style.top = "";
				}
			}, 0); // Issue: IE11 might require longer delay

			return stickyContainer;
		}

	};
	return zs;
})(window.zs || {});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Mar 05 2019 14:30:14 GMT+0530 (India Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
